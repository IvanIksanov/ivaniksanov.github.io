<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <title>OSI: 7 уровней с упором на безопасность</title>

    <!-- Стили проекта (подключаем существующие) -->
    <link rel="stylesheet" href="header.css" />
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" href="img/QAtoDev_PageIcon.png" sizes="32x32" type="image/png" />

    <!-- Локальные стили страницы OSI -->
    <style>
        /* -------- Каркас страницы OSI (вписывается в общую визуальную систему) -------- */
        .osi-hero {
          text-align: center;
          margin: 0 auto 0.5rem;
        }

        .osi-legend {
          margin: 0 auto 1rem;
          max-width: 900px;
          background: #fafafa;
          border-radius: 8px;
          border: 2px solid #44BBC1;
          padding: 0.75rem;
          font-size: 0.95rem;
        }

        .osi-layout {
          display: grid;
          grid-template-columns: 260px 1fr;
          gap: 1rem;
          align-items: start;
          max-width: 1200px;
          margin: 0 auto;
        }

        /* -------- Меню вкладок слева -------- */
        .osi-menu {
          position: sticky;
          top: 80px; /* ниже «липкой» шапки проекта */
          align-self: start;
          border-radius: 10px;
          background: #fafafa;
          padding: 0.5rem;
        }

        .osi-menu h3 {
          margin: 0.25rem 0 0.5rem;
          text-align: center;
          font-size: 1rem;
        }

        .osi-tablist {
          list-style: none;
          margin: 0;
          padding: 0;
        }

        .osi-tab {
          width: 100%;
          display: flex;
          align-items: center;
          gap: 8px;
          padding: 10px 12px;
          margin: 6px 0;
          border-radius: 8px;
          border: 1px solid #e5e5e5;
          color: #1A1A1A;
          cursor: pointer;
          transition: background 0.2s, color 0.2s, border-color 0.2s, transform 0.08s ease-in-out;
          text-align: left;
        }

        .osi-tab:hover {
          background: #f5fafa;
          transform: translateY(-1px);
        }

        .osi-tab[aria-selected="true"] {
          border-color: #44BBC1;
          background: #eaf8f9;
          box-shadow: inset 0 0 0 2px rgba(68,187,193,.15);
        }

        .osi-layer-badge {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          min-width: 28px;
          height: 28px;
          padding: 0 8px;
          border-radius: 999px;
          font-size: 0.85rem;
          background: #44BBC1;
          color: #fff;
        }

        .osi-proto-chip {
          margin-left: auto;
          font-size: 0.72rem;
          color: #666;
          background: #f3f3f3;
          padding: 2px 8px;
          border-radius: 999px;
          border: 1px solid #eee;
        }

        /* -------- Контент справа -------- */
        .osi-content {
          border: none;
        }

        .tab-panel {
          display: none;
          border: none;
          background: #FAFAFA;
          border-radius: 8px;
          padding: 1rem;
          margin: 0;
        }

        .tab-panel.active {
          display: block;
          border: 2px solid #44BBC1;
        }

        .panel-head {
          display: flex;
          align-items: center;
          gap: 10px;
          margin: 0 0 6px;
        }

        .panel-head .badge {
          background: #44BBC1;
          color: #fff;
          border-radius: 999px;
          padding: 2px 10px;
          font-size: 0.85rem;
        }

        .panel-grid {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 0.75rem;
        }

        .panel-card {
          background: #fff;
          border: 1px solid #e8e8e8;
          border-radius: 10px;
          padding: 0.85rem;
        }

        .panel-card h4 {
          margin-top: 0;
          margin-bottom: 0.35rem;
          font-size: 1.05rem;
        }

        .muted {
          color: #555;
          font-size: 0.95rem;
        }

        .inline-code {
          font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
          font-size: 0.9rem;
          background: #f6f6f6;
          border: 1px solid #eee;
          border-radius: 6px;
          padding: 0.05rem 0.35rem;
        }

        .cmd {
          background: #111;
          color: #f5f5f5;
          border-radius: 8px;
          padding: 0.75rem;
          overflow-x: auto;
          font-size: 0.9rem;
          line-height: 1.35;
        }

        .checklist {
          margin: 0.25rem 0 0.25rem 1rem;
          padding-left: 0.25rem;
        }

        .checklist li + li {
          margin-top: 4px;
        }

        details summary {
          cursor: pointer;
          user-select: none;
        }

        .inline-note {
          background: #fff7e6;
          border: 1px solid #ffe0a6;
          color: #6a4a00;
          padding: 6px 10px;
          border-radius: 6px;
          font-size: 0.9rem;
        }

        .panel-footer {
          margin-top: 0.5rem;
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 0.5rem;
        }

        .pill {
          display: inline-block;
          padding: 6px 10px;
          border-radius: 999px;
          background: #f0f0f0;
          color: #333;
          border: 1px solid #e6e6e6;
          font-size: 0.85rem;
        }

        /* -------- Адаптивность -------- */
        @media (max-width: 1100px) {
          .panel-grid, .panel-footer { grid-template-columns: 1fr; }
        }

        @media (max-width: 900px) {
          .osi-layout {
            grid-template-columns: 1fr;
          }
          .osi-menu {
            position: static;
            overflow-x: auto;
            white-space: nowrap;
            display: flex;
            gap: 0.5rem;
            border-radius: 8px;
          }
          .osi-menu h3 { display: none; }
          .osi-tablist {
            display: flex;
            gap: 0.5rem;
          }
          .osi-tab {
            display: inline-flex;
            width: auto;
            white-space: nowrap;
            padding: 8px 10px;
          }
          .osi-proto-chip { display: none; }
        }

        /* -------- Темная тема (следуем конвенции проекта) -------- */
        html[data-theme="dark"] .osi-legend { background: #242424; }
        html[data-theme="dark"] .osi-menu { background: #242424; }
        html[data-theme="dark"] .osi-tab {
          background: #1A1A1A;
          color: #f1f1f1;
          border-color: #333;
        }
        html[data-theme="dark"] .osi-tab:hover { background: #252525; }
        html[data-theme="dark"] .osi-tab[aria-selected="true"] {
          background: #0f1f20;
          border-color: #44BBC1;
          box-shadow: inset 0 0 0 2px rgba(68,187,193,.15);
        }
        html[data-theme="dark"] .tab-panel { background: #242424; }
        html[data-theme="dark"] .panel-card { background: #1A1A1A; border-color: #333; }
        html[data-theme="dark"] .cmd { background: #0e0e0e; color: #e9e9e9; }
        html[data-theme="dark"] .inline-code { background: #2a2a2a; border-color: #3a3a3a; color: #eee; }
        html[data-theme="dark"] .inline-note {
          background: #3a2f13;
          border-color: #6f581c;
          color: #ffe0a6;
        }
        html[data-theme="dark"] .pill {
          background: #2a2a2a;
          color: #e9e9e9;
          border-color: #3a3a3a;
        }
    </style>
</head>

<body>
<!-- Навигация проектов -->
<nav>
    <ul>
        <li><a href="hwois.html">Кто такой тестировщик?</a></li>
        <li><a href="roadmap.html">Roadmap</a></li>
        <li><a href="questions.html">Вопросы</a></li>
        <li><a href="interview.html">Интервью</a></li>
        <li><a href="practice.html">Практика</a></li>
    </ul>
</nav>

<!-- Шапка в стиле проекта -->
<header class="welcome">
    <div class="header-container">
        <div class="logo" style="cursor: pointer" onclick="window.location.href='index.html'">
            <img src="img/QAtoDev_(Flappy_Bird_style).png" alt="Логотип" />
        </div>
        <h3 class="site-title">На главную</h3>
    </div>

    <!-- выносим кнопку туды-перёды -->
    <div class="theme-switcher">
        <button
                id="theme-toggle"
                class="clean-btn toggleButton_gllP"
                type="button"
                title="Переключить тему"
                aria-label="Переключить тему"
                aria-live="polite"
        >
            <!-- Солнце для светлой темы -->
            <svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR">
                <path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path>
            </svg>
            <!-- Полумесяц для тёмной темы -->
            <svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR">
                <path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path>
            </svg>
        </button>
    </div>
</header>

<main class="article" style="max-width: 1200px;">
    <div class="osi-hero">
        <h2 style="margin-bottom: .4rem;">Модель OSI: 7 уровней — шпаргалка тестировщика безопасности</h2>
        <p class="muted" style="margin: 0;">
            Слева — вкладки уровней, справа — разбор: кратко, устройства/протоколы, типовые риски, идеи проверок, метрики.
        </p>
    </div>

    <section class="osi-layout">
        <!-- Меню вкладок -->
        <aside class="osi-menu" aria-label="Уровни OSI">
            <h3>Вкладки уровней</h3>
            <ul class="osi-tablist" role="tablist" aria-orientation="vertical">
                <li>
                    <button class="osi-tab" role="tab" aria-selected="true" aria-controls="tab-l1" id="tabbtn-l1" data-target="#tab-l1">
                        <span class="osi-layer-badge">L1</span> Физический
                    </button>
                </li>
                <li>
                    <button class="osi-tab" role="tab" aria-selected="false" aria-controls="tab-l2" id="tabbtn-l2" data-target="#tab-l2">
                        <span class="osi-layer-badge">L2</span> Канальный
                    </button>
                </li>
                <li>
                    <button class="osi-tab" role="tab" aria-selected="false" aria-controls="tab-l3" id="tabbtn-l3" data-target="#tab-l3">
                        <span class="osi-layer-badge">L3</span> Сетевой
                    </button>
                </li>
                <li>
                    <button class="osi-tab" role="tab" aria-selected="false" aria-controls="tab-l4" id="tabbtn-l4" data-target="#tab-l4">
                        <span class="osi-layer-badge">L4</span> Транспортный
                    </button>
                </li>
                <li>
                    <button class="osi-tab" role="tab" aria-selected="false" aria-controls="tab-l5" id="tabbtn-l5" data-target="#tab-l5">
                        <span class="osi-layer-badge">L5</span> Сеансовый
                    </button>
                </li>
                <li>
                    <button class="osi-tab" role="tab" aria-selected="false" aria-controls="tab-l6" id="tabbtn-l6" data-target="#tab-l6">
                        <span class="osi-layer-badge">L6</span> Представления
                    </button>
                </li>
                <li>
                    <button class="osi-tab" role="tab" aria-selected="false" aria-controls="tab-l7" id="tabbtn-l7" data-target="#tab-l7">
                        <span class="osi-layer-badge">L7</span> Прикладной
                    </button>
                </li>
            </ul>
        </aside>

        <!-- Контент вкладок -->
        <div class="osi-content">
            <!-- L1 -->
            <section id="tab-l1" class="tab-panel active" role="tabpanel" aria-labelledby="tabbtn-l1">
                <div class="panel-head">
                    <h3 style="margin: 0;">L1 — Физический уровень</h3>
                    <span class="badge">Кабели, разъемы, оптика, RF</span>
                </div>

                <p class="muted">
                    Передача битов по среде. Важны качество линии, помехи, доступ к помещениям/портам.
                </p>

                <div class="panel-grid">
                    <div class="panel-card">
                        <h4>Устройства и примеры</h4>
                        <ul class="checklist">
                            <li>Патч-панели, свитчи (порт как физический интерфейс), медиаконвертеры</li>
                            <li>Оптика (SFP/SFP+), медь (Cat5e/Cat6), PoE-инжекторы</li>
                            <li>Радиоканалы: Wi-Fi, LoRa/BT, LTE (антенны, усилители)</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Риски безопасности</h4>
                        <ul class="checklist">
                            <li>Несанкционированное подключение к портам, «тройники», мини-хабы</li>
                            <li>Перехват через физический доступ (tap/разветвитель, злонамеренный AP)</li>
                            <li>Jamming/глушение RF, деградация канала → отказ в обслуживании</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Идеи тестов безопасности</h4>
                        <ul class="checklist">
                            <li>Проверка отключенных портов/802.1X: нет ли линка и DHCP-ответа</li>
                            <li>Отказоустойчивость: обрывы/вставки, деградация (длинный/битый патчкорд)</li>
                            <li>RF-профилирование: карта уровней сигнала, «мёртвые зоны», переизлучение</li>
                        </ul>
                        <details style="margin-top:.35rem;">
                            <summary><span class="inline-code">ethtool</span>, <span class="inline-code">iperf3</span> — быстрая диагностика</summary>
                            <pre class="cmd">
# Скорость линка/автосогласование
ethtool eth0

# Сквозная пропускная способность
iperf3 -s           # на сервере
iperf3 -c &lt;ip&gt; -t 10 # на клиенте
                </pre>
                        </details>
                    </div>
                    <div class="panel-card">
                        <h4>Метрики и наблюдаемость</h4>
                        <ul class="checklist">
                            <li>Ошибки/дропы на интерфейсах, flap-интервалы</li>
                            <li>Уровень RSSI/SNR (для RF), доля повторных передач</li>
                            <li>Инвентаризация портов: порт-security, 802.1X включён?</li>
                        </ul>
                        <p class="inline-note">Практика: отключайте «ненужные» розетки по умолчанию, используйте 802.1X + MAB.</p>
                    </div>
                </div>
            </section>

            <!-- L2 -->
            <section id="tab-l2" class="tab-panel" role="tabpanel" aria-labelledby="tabbtn-l2">
                <div class="panel-head">
                    <h3 style="margin: 0;">L2 — Канальный уровень</h3>
                    <span class="badge">Ethernet, 802.1Q, Wi-Fi (MAC)</span>
                </div>

                <p class="muted">
                    Кадры и адреса MAC, сегментация по VLAN, базовая аутентификация на порту.
                </p>

                <div class="panel-grid">
                    <div class="panel-card">
                        <h4>Устройства/технологии</h4>
                        <ul class="checklist">
                            <li>Коммутаторы L2/L3, точки доступа</li>
                            <li>VLAN, Trunk/Access, STP/RSTP, LACP</li>
                            <li>Port Security, 802.1X/MAB, DHCP Snooping, DAI, IP Source Guard</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Риски и атаки</h4>
                        <ul class="checklist">
                            <li>MAC spoofing, обход Port-Security</li>
                            <li>VLAN hopping (double-tagging), незащищённые native-VLAN</li>
                            <li>ARP-spoofing/poisoning → перехват трафика (MiTM)</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Идеи тестов безопасности</h4>
                        <ul class="checklist">
                            <li>Проверить DAI/DHCP Snooping: попытка ARP-poisoning и Rogue-DHCP</li>
                            <li>Проверить Port-Security: лимиты MAC, sticky, violation-action</li>
                            <li>802.1X: гостевой VLAN, MAB fallback, отключение доступа при неуспехе</li>
                        </ul>
                        <details style="margin-top:.35rem;">
                            <summary>Быстрые приемы (демо-сценарии)</summary>
                            <pre class="cmd">
# Отправка ARP-ответов (проверка DAI)
arpspoof -i eth0 -t VICTIM_IP GW_IP

# Фиксация MAC интерфейса (проверка Port Security реакции)
ip link set dev eth0 address 02:de:ad:be:ef:01
                </pre>
                        </details>
                    </div>
                    <div class="panel-card">
                        <h4>Метрики и признаки</h4>
                        <ul class="checklist">
                            <li>Таблица MAC: частые смены на порту (flapping), нарушения Port-Security</li>
                            <li>Логи DAI/DHCP Snooping: блокировки/alarms</li>
                            <li>Аудит VLAN: отсутствие «общего» native-VLAN на trunk’ах</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- L3 -->
            <section id="tab-l3" class="tab-panel" role="tabpanel" aria-labelledby="tabbtn-l3">
                <div class="panel-head">
                    <h3 style="margin: 0;">L3 — Сетевой уровень</h3>
                    <span class="badge">IP, маршрутизация, ACL</span>
                </div>

                <p class="muted">
                    IP-адресация и маршруты. Фильтрация трафика, зональная сегментация, NAT.
                </p>

                <div class="panel-grid">
                    <div class="panel-card">
                        <h4>Технологии и устройства</h4>
                        <ul class="checklist">
                            <li>Маршрутизаторы/L3-коммутаторы, межсетевые экраны</li>
                            <li>Статическая/динамическая маршрутизация (OSPF/BGP)</li>
                            <li>ACL/Firewall-policy, VRF, NAT, IPsec</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Риски и атаки</h4>
                        <ul class="checklist">
                            <li>IP spoofing, ICMP-tunnel, неограниченные lateral-movement</li>
                            <li>Ошибки ACL: «permit any», теневая политика, неучтённые сервисы</li>
                            <li>Необоснованные статические маршруты/утечки BGP</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Идеи тестов безопасности</h4>
                        <ul class="checklist">
                            <li>Проверка изоляции сегментов: недоступность межзонных портов по умолчанию</li>
                            <li>Negative-тесты ICMP/UDP/TCP к системным IP (loopback/management)</li>
                            <li>Тест на «болезнь» any-to-any: скан диапазона источников</li>
                        </ul>
                        <details style="margin-top:.35rem;">
                            <summary><span class="inline-code">nmap</span> и <span class="inline-code">hping3</span> для ACL/файрвола</summary>
                            <pre class="cmd">
# Три SYN в секунду от подставного источника (если поддерживается)
sudo hping3 -S -p 22 -a 10.10.10.10 --flood --rand-source TARGET

# Проверка фильтрации ICMP/UDP/TCP
nmap -sS -Pn -p 1-1024 TARGET
nmap -sU -Pn -p 53,123,161 TARGET
nmap -PE -sn TARGET/24
                </pre>
                        </details>
                    </div>
                    <div class="panel-card">
                        <h4>Метрики/наблюдаемость</h4>
                        <ul class="checklist">
                            <li>Hit-count по правилам ACL/Firewall, «правила-пылесосы» с высоким хитом</li>
                            <li>NetFlow/IPFIX: кто с кем и по каким портам общается</li>
                            <li>Аудит «зон»: наличие deny-all в конце каждой политики</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- L4 -->
            <section id="tab-l4" class="tab-panel" role="tabpanel" aria-labelledby="tabbtn-l4">
                <div class="panel-head">
                    <h3 style="margin: 0;">L4 — Транспортный уровень</h3>
                    <span class="badge">TCP, UDP, QUIC</span>
                </div>

                <p class="muted">
                    Порты, сессии и надёжность доставки. DDoS/DoS, stateful-фильтрация, балансировка.
                </p>

                <div class="panel-grid">
                    <div class="panel-card">
                        <h4>Устройства/функции</h4>
                        <ul class="checklist">
                            <li>Stateful-FW, L4-балансировщики (SLB), WAF/L7-баланс при необходимости</li>
                            <li>SYN-cookies, connection-limits, rate-limit/ConnTrack</li>
                            <li>QUIC/HTTP3 особенности (UDP-основано)</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Риски и атаки</h4>
                        <ul class="checklist">
                            <li>SYN-flood/ACK-flood, UDP-амплификации</li>
                            <li>Исчерпание таблиц состояний на FW/балансировщике</li>
                            <li>Неправильные time-wait, неограниченный backlog</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Идеи тестов безопасности</h4>
                        <ul class="checklist">
                            <li>Ограничения соединений/сек, burst-лимиты на порт</li>
                            <li>Проверка «миграции» порта (service-move) и корректности health-checks</li>
                            <li>Позитив/негатив для QUIC: разрешён ли, логируется ли</li>
                        </ul>
                        <details style="margin-top:.35rem;">
                            <summary>Мини-нагрузка TCP</summary>
                            <pre class="cmd">
# Полезная «безопасная» проверка SYN cookies/limit'ов
hping3 -S -p 443 --faster TARGET

# Проверка UDP-порта
nping --udp -p 123 TARGET --rate 50 --count 200
                </pre>
                        </details>
                    </div>
                    <div class="panel-card">
                        <h4>Метрики</h4>
                        <ul class="checklist">
                            <li>Соединения в секунду (CPS), открытые сессии, дропы по лимиту</li>
                            <li>Latency при пике CPS, % ошибок handshake</li>
                            <li>Срабатывания DoS-защиты (SYN cookies, rate-limit)</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- L5 -->
            <section id="tab-l5" class="tab-panel" role="tabpanel" aria-labelledby="tabbtn-l5">
                <div class="panel-head">
                    <h3 style="margin: 0;">L5 — Сеансовый уровень</h3>
                    <span class="badge">TLS/DTLS, RPC, сессии приложений</span>
                </div>

                <p class="muted">
                    Установление/поддержание диалогов. Контекст сеанса, повторное использование, возобновление.
                </p>

                <div class="panel-grid">
                    <div class="panel-card">
                        <h4>Примеры</h4>
                        <ul class="checklist">
                            <li>TLS-handshake/возобновление/ALPN, DTLS для UDP</li>
                            <li>RPC/GRPC-сессии, WebSocket</li>
                            <li>SSO-сессии (OIDC/SAML) — логич. привязка к L7, но жизненный цикл — сеансовый</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Риски</h4>
                        <ul class="checklist">
                            <li>Сеансовое похищение/фиксация (session fixation), слабая привязка (IP/UA)</li>
                            <li>Слабые наборы шифров/версии, нестрогая проверка сертификатов</li>
                            <li>Неверные таймауты/реюз сессии → эскалация прав</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Идеи тестов безопасности</h4>
                        <ul class="checklist">
                            <li>Проверка TLS-профиля: версии, шифры, HSTS/OCSP Stapling (если уместно)</li>
                            <li>Session fixation: авторизация с предзаданным <span class="inline-code">session_id</span></li>
                            <li>Принудительное завершение: таймауты, отзыв refresh-токена (SSO)</li>
                        </ul>
                        <details style="margin-top:.35rem;">
                            <summary>Инструменты проверки TLS</summary>
                            <pre class="cmd">
# Список поддерживаемых версий/шифров
openssl s_client -connect host:443 -tls1_2 -servername host -brief

# Быстрая проверка сертификата/цепочки
echo | openssl s_client -showcerts -connect host:443 -servername host
                </pre>
                        </details>
                    </div>
                    <div class="panel-card">
                        <h4>Метрики</h4>
                        <ul class="checklist">
                            <li>Процент возобновления TLS, неуспешные handshakes</li>
                            <li>Доля истёкших/отозванных сертификатов в инвентаризации</li>
                            <li>Средняя длительность пользовательской сессии, доля «подвешенных» сессий</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- L6 -->
            <section id="tab-l6" class="tab-panel" role="tabpanel" aria-labelledby="tabbtn-l6">
                <div class="panel-head">
                    <h3 style="margin: 0;">L6 — Уровень представления</h3>
                    <span class="badge">Форматы, кодирование, шифрование</span>
                </div>

                <p class="muted">
                    Трансформация данных: сериализация/десериализация, сжатие, шифрование/подпись.
                </p>

                <div class="panel-grid">
                    <div class="panel-card">
                        <h4>Примеры</h4>
                        <ul class="checklist">
                            <li>JSON, XML, Protobuf, ASN.1</li>
                            <li>Base64, gzip/deflate, TLS-шифрование на границе</li>
                            <li>Кодировки (UTF-8/UTF-16), трансляция числовых форматов</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Риски</h4>
                        <ul class="checklist">
                            <li>Insecure deserialization, XML-эксплойты (XXE), зип-бомбы</li>
                            <li>Смешанные/некорректные кодировки → обход валидации</li>
                            <li>Слабые/устаревшие алгоритмы шифрования/подписи</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Идеи тестов безопасности</h4>
                        <ul class="checklist">
                            <li>Fuzz сериализации: неожиданные типы/длины/дубликаты полей</li>
                            <li>Перекодировка: Unicode-homoglyphs, overlong UTF-8</li>
                            <li>Проверка anti-XXE, лимиты распаковки (zip-bomb limits)</li>
                        </ul>
                        <details style="margin-top:.35rem;">
                            <summary>Быстрый fuzz JSON/XML</summary>
                            <pre class="cmd">
# Отправка «тяжёлых» полезных нагрузок
curl -X POST https://host/api -H "Content-Type: application/json" \
  --data-binary @payload-weird.json

curl -X POST https://host/api -H "Content-Type: application/xml" \
  --data-binary @payload-xxe.xml
                </pre>
                        </details>
                    </div>
                    <div class="panel-card">
                        <h4>Метрики</h4>
                        <ul class="checklist">
                            <li>Доля отказов парсинга, распределение по причинам</li>
                            <li>Coverage негативных кейсов десериализации в автотестах</li>
                            <li>Инвентаризация алгоритмов/ключей (алерты по устаревшим)</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- L7 -->
            <section id="tab-l7" class="tab-panel" role="tabpanel" aria-labelledby="tabbtn-l7">
                <div class="panel-head">
                    <h3 style="margin: 0;">L7 — Прикладной уровень</h3>
                    <span class="badge">HTTP(S), DNS, SMTP, gRPC…</span>
                </div>

                <p class="muted">
                    Логика приложений и протоколов верхнего уровня. Наиболее частая цель атак.
                </p>

                <div class="panel-grid">
                    <div class="panel-card">
                        <h4>Примеры протоколов/устройств</h4>
                        <ul class="checklist">
                            <li>HTTP(S)/REST, GraphQL, gRPC, WebSocket</li>
                            <li>DNS (рекурсоры/авторитативные), SMTP/IMAP</li>
                            <li>WAF, API-шлюзы, rate-limit сервисы</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Основные риски</h4>
                        <ul class="checklist">
                            <li>Валидация ввода: инъекции, десериализация, RCE</li>
                            <li>AuthN/AuthZ: обходы, IDOR, неправильные роли/политики</li>
                            <li>SSRF, CSRF, XSS, логические изъяны бизнес-процессов</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>Идеи тестов безопасности</h4>
                        <ul class="checklist">
                            <li>Негатив на границах схем: обязательность/типы/ограничения, unknown-fields</li>
                            <li>Аутентификация: принудительный logout, re-auth на критичных действиях</li>
                            <li>Авторизация: проверка каждого эндпойнта на «чужие» объекты (IDOR)</li>
                        </ul>
                        <details style="margin-top:.35rem;">
                            <summary>Полезные команды</summary>
                            <pre class="cmd">
# Быстрый перебор методов и заголовков
curl -X OPTIONS -i https://host/api
curl -H "X-Forwarded-For: 127.0.0.1" https://host/admin

# Негатив на rate-limit (осторожно!)
for i in {1..50}; do curl -s -o /dev/null https://host/api/expensive; done
                </pre>
                        </details>
                    </div>
                    <div class="panel-card">
                        <h4>Метрики и сигналы</h4>
                        <ul class="checklist">
                            <li>4xx/5xx по маршрутам, распределение причин</li>
                            <li>Аномалии аутентификации (рост неуспешных логинов, гео/UA-аномалии)</li>
                            <li>Срабатывания WAF/IDS, частота ограничений (rate-limit/quota)</li>
                        </ul>
                    </div>
                </div>

                <div class="panel-footer">
                    <div class="panel-card">
                        <h4>Мини-чек-лист API</h4>
                        <ul class="checklist">
                            <li>Схемы: строгая валидация, запрет лишних полей</li>
                            <li>AuthN/AuthZ: кратность токенов, привязка сессии, «наименьшие привилегии»</li>
                            <li>Логи: корреляция запросов, маскирование чувствительных данных</li>
                        </ul>
                    </div>
                    <div class="panel-card">
                        <h4>DNS/SMTP тесты</h4>
                        <ul class="checklist">
                            <li>DNS-рекурсия: запрещена на авторитативных серверах</li>
                            <li>SPF/DKIM/DMARC корректно выставлены</li>
                            <li>DNS-амплификация: открыт ли рекурсер наружу</li>
                        </ul>
                        <pre class="cmd" style="margin-top:.35rem;">
dig ANY yourzone.tld @ns.example
dig +rec @public-resolver example.com
              </pre>
                    </div>
                </div>
            </section>
        </div>
    </section>
</main>

<footer class="qatodev">
    <p>&copy; <span class="footer-year" data-footer-year></span> QAtoDev</p>
</footer>

<script src="header.js"></script>
<!-- Скрипт: переключение темы (как на других страницах проекта) -->
<script>
    (function () {
      const root = document.documentElement;
      const btn = document.getElementById("theme-toggle");
      const saved = localStorage.getItem("theme");
      if (saved === "dark" || saved === "light") {
        root.setAttribute("data-theme", saved);
        btn?.classList.toggle("active", saved === "dark");
      }
      btn?.addEventListener("click", () => {
        const next = root.getAttribute("data-theme") === "dark" ? "light" : "dark";
        root.setAttribute("data-theme", next);
        localStorage.setItem("theme", next);
        btn.classList.toggle("active", next === "dark");
      });
    })();
</script>

<!-- Скрипт: автосмена логотипа (как в проекте) -->
<script>
    (function () {
      const imgs = [
        "img/QAtoDev_(Flappy_Bird_style).png",
        "img/QAtoDev_Classic.png",
        "img/QAtoDev_new_year.png",
        "img/QAtoDev_DayQA.png",
        "img/QAtoDev_Halloween.png",
        "img/QAtoDev_BlackAndWhite.png",
        "img/QAtoDev_CoverChatChannel.png",
      ];
      let idx = parseInt(localStorage.getItem("logoIdx"), 10);
      if (isNaN(idx) || idx < 0 || idx >= imgs.length) idx = 0;
      const logoImg = document.querySelector(".logo img");
      const faviconTag = document.querySelector('link[rel="icon"]');
      function updateLogo() {
        const src = imgs[idx];
        if (logoImg) logoImg.src = src;
        if (faviconTag) faviconTag.href = src;
      }
      updateLogo();
      setInterval(() => {
        idx = (idx + 1) % imgs.length;
        localStorage.setItem("logoIdx", idx);
        updateLogo();
      }, 50000);
    })();
</script>

<!-- Скрипт: логика вкладок (доступность + deep link через hash) -->
<script>
    (function () {
      const tabButtons = Array.from(document.querySelectorAll(".osi-tab"));
      const panels = Array.from(document.querySelectorAll(".tab-panel"));

      function activate(targetId) {
        // Кнопки
        tabButtons.forEach((btn) => {
          const match = btn.getAttribute("data-target") === "#" + targetId;
          btn.setAttribute("aria-selected", match ? "true" : "false");
          if (match) btn.focus({ preventScroll: true });
        });
        // Панели
        panels.forEach((p) => {
          p.classList.toggle("active", p.id === targetId);
        });
      }

      // Клик по вкладке
      tabButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const sel = btn.getAttribute("data-target");
          if (!sel) return;
          const id = sel.replace("#", "");
          if (history.pushState) {
            history.pushState(null, "", "#" + id);
          } else {
            location.hash = "#" + id;
          }
          activate(id);
        });

        // Клавиатура (стрелки)
        btn.addEventListener("keydown", (e) => {
          if (!["ArrowUp", "ArrowDown", "Home", "End"].includes(e.key)) return;
          e.preventDefault();
          const idx = tabButtons.indexOf(btn);
          let nextIdx = idx;
          if (e.key === "ArrowUp") nextIdx = (idx - 1 + tabButtons.length) % tabButtons.length;
          if (e.key === "ArrowDown") nextIdx = (idx + 1) % tabButtons.length;
          if (e.key === "Home") nextIdx = 0;
          if (e.key === "End") nextIdx = tabButtons.length - 1;
          tabButtons[nextIdx].click();
        });
      });

      // При загрузке: активируем из hash
      const initial = (location.hash || "#tab-l1").replace("#", "");
      if (document.getElementById(initial)) {
        activate(initial);
      } else {
        activate("tab-l1");
      }

      // Реакция на навигацию по истории
      window.addEventListener("hashchange", () => {
        const id = (location.hash || "#tab-l1").replace("#", "");
        activate(id);
      });
    })();
</script>
</body>
</html>
