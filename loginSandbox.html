<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Страница авторизации</title>
    <link rel="stylesheet" href="header.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="pageBooks.css">
    <link rel="icon" href="img/QAtoDev_PageIcon.png" sizes="32x32" type="image/png">
    <!-- Доп. минимальные стили только для поп-апа -->
    <style>
        /* Базовая подложка модального окна */
        .modal-backdrop {
          position: fixed;
          inset: 0;
          background: rgba(0,0,0,0.5);
          display: none; /* по умолчанию скрыто */
          align-items: center;
          justify-content: center;
          z-index: 9999;
        }
        .modal-backdrop.show {
          display: flex;
        }
        /* Контейнер модального окна */
        .modal {
          background: var(--ifm-background-color, #fff);
          color: var(--ifm-font-color-base, #111);
          border-radius: 12px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.25);
          width: min(90vw, 420px);
          padding: 20px 20px 16px;
          position: relative;
        }
        .modal h3 {
          margin: 0 0 8px 0;
          font-size: 18px;
          line-height: 1.3;
        }
        .modal p {
          margin: 0 0 16px 0;
          font-size: 15px;
        }
        .modal .modal-actions {
          display: flex;
          gap: 8px;
          justify-content: flex-end;
        }
        .modal .btn {
          cursor: pointer;
          border: none;
          border-radius: 10px;
          padding: 10px 14px;
          font-size: 14px;
        }
        .modal .btn-primary {
          background: #FFA001;
          color: #111;
        }
        .modal .btn-secondary {
          background: #e5e7eb;
          color: #111;
        }
        /* Кнопка закрытия (икс) */
        .modal .close-x {
          position: absolute;
          top: 8px;
          right: 10px;
          font-size: 22px;
          line-height: 1;
          background: none;
          border: none;
          cursor: pointer;
          color: inherit;
        }
    </style>

</head>
<body>
<nav>
    <ul>
        <li><a href="hwois.html">Кто такой тестировщик?</a></li>
        <li><a href="index.html">Roadmap</a></li>
        <li><a href="questions.html">Вопросы</a></li>
        <li><a href="pageBooks.html">Книги</a></li>
        <li><a href="index.html" style="background-color: #FFA001;">Логин</a></li>
        <li><a href="interview.html">Интервью</a></li>
        <li><a href="swagger_api.html">API Magic</a></li>
    </ul>
</nav>

<header class="welcome">
    <div class="header-container">
        <div class="logo"
             style="cursor: pointer;"
             onclick="window.location.href='index.html'">
            <img src="img/QAtoDev_(Flappy_Bird_style).png" alt="Логотип">
        </div>
        <h3 class="site-title">На главную</h3>
    </div>
    <div class="theme-switcher">
        <button
                id="theme-toggle"
                class="clean-btn toggleButton_gllP"
                type="button"
                title="Переключить тему"
                aria-label="Переключить тему"
                aria-live="polite"
        >
            <!-- Солнце для светлой темы -->
            <svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR">
                <path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path>
            </svg>
            <!-- Полумесяц для тёмной темы -->
            <svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR">
                <path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path>
            </svg>
        </button>
    </div>
</header>

<div class="page-header article">
    <h2>Протестируй страницу авторизации</h2>
</div>
    <br><br>
    <!-- Переключатель способа входа -->
    <div class="login-toggle" style="text-align:center; margin-bottom:15px;">
        <label><input type="radio" name="login-method" value="phone" checked> Телефон</label>
        &nbsp;&nbsp;
        <label><input type="radio" name="login-method" value="email"> Email</label>
    </div>

<!-- Модалка ошибок логина -->
<div id="error-modal-backdrop" class="modal-backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="error-modal-title">
        <button id="error-modal-close-x" class="close-x" aria-label="Закрыть">×</button>
        <h3 id="error-modal-title">Упс! Повторите попытку позже</h3>
        <p id="error-modal-text">Что-то пошло не так</p>
        <div class="modal-actions">
            <button id="error-modal-details" class="btn btn-secondary" type="button">Подробнее</button>
            <button id="error-modal-ok" class="btn btn-primary" type="button">Ок</button>
        </div>
    </div>
</div>


    <!-- Форма входа -->
    <form id="login-form" style="max-width:400px; margin:0 auto; display:flex; flex-direction:column;">
        <!-- Телефон -->
        <div id="phone-container" class="input-container">
            <div class="input-wrapper" style="position:relative;">
                <input type="tel" id="phone-input" placeholder="+7 (___) ___-__-__">
                <button type="button" class="clean-btn" id="clear-phone"
                        style="position:absolute; right:10px; top:50%; transform:translateY(-50%); display:none; font-size:16px; background:none; border:none; cursor:pointer;">
                    &times;
                </button>
            </div>
            <small class="hint">Номер должен содержать 10 цифр (вместе с +7)</small>
        </div>

        <!-- Email -->
        <div id="email-container" class="input-container" style="display:none;">
            <div class="input-wrapper" style="position:relative;">
                <input type="email" id="email-input" placeholder="primer@mail.ru">
                <button type="button" class="clean-btn" id="clear-email"
                        style="position:absolute; right:10px; top:50%; transform:translateY(-50%); display:none; font-size:16px; background:none; border:none; cursor:pointer;">
                    &times;
                </button>
            </div>
            <small class="hint">Введите корректный email</small>
        </div>

        <!-- Пароль -->
        <div class="input-container">
            <div class="input-wrapper" style="position:relative;">
                <input type="password" id="password-input" placeholder="Пароль">
                <button type="button" class="clean-btn" id="clear-password"
                        style="position:absolute; right:10px; top:50%; transform:translateY(-50%); display:none; font-size:16px; background:none; border:none; cursor:pointer;">
                    &times;
                </button>
            </div>
            <small id="password-strength" class="hint"></small>
        </div>

        <!-- Кнопка входа -->
        <button type="button" id="login-button" class="carousel-button" style="align-self:center; margin-top:10px;">
            Войти
        </button>
    </form>
    <br><br>

<section id="instruction" class="article">
    <div class="selection-container">
        <div class="selection-item">
            <p>Это самое популярное практическое задание, которое дают тестировщику для отбора на техническое собеседование. Практика тебе точно не помешает! Чтобы приступить, выбери одно из условий тестового задания:<br><br>
                1) Проверь логин форму по структурированному чек-листу - справа внизу (лёгкий)<br><br>
                2) Протестируй страницу авторизации с помощью трех тест-кейсов (средний)<br><br>
                3) Проведи ad-hoc тестирование, опираясь на свой пользовательский опыт (сложный)<br><br>
                4) Какие по вашему мнению проверки стоит убрать из чек-листа, а какие стоит добавить? (дополнительно)
            </p>
        </div>
    </div>
</section>

<footer class="qatodev">
    <p>
        <a href="https://t.me/QAtoDev" target="_blank" style="background-color: #FFA001;">Telegram</a>
        <a href="https://set.ki/channel/PJnPK69" target="_blank" style="background-color: #FFA001;">Сетка</a>
    </p>
</footer>

<!-- Кнопка -->
<button class="bug-fab" id="bugFabB" title="Показать чек-лист">✍🏻</button>

<!-- Панель чек-листа -->
<div class="bug-panel" id="bugPanelB" role="dialog" aria-label="Список проверок">
    <h4>Список проверок (чек-лист):</h4>

    <!-- Контейнер для списка -->
    <div class="bug-list" id="bugListB"></div>

    <!-- Единый HTML-шаблон одного пункта -->
    <template id="bugItemTplB">
        <div class="bug-item" data-bug-id="" style="margin: 8px 0;">
            <div class="bug-text"></div>
            <div class="bug-actions">
                <button class="icon-btn btn-open"  title="Баг" aria-label="Баг">🐞</button>
                <button class="icon-btn btn-fixed" title="Успешно"      aria-label="Успешно">👍</button>
            </div>
            <div class="bug-status" aria-live="polite"></div>
        </div>
    </template>
</div>

<script>
    (function(){
      const fab   = document.getElementById('bugFabB');
      const panel = document.getElementById('bugPanelB');
      const list  = document.getElementById('bugListB');
      const tpl   = document.getElementById('bugItemTplB');

      // УНИКАЛЬНЫЙ ключ хранилища для этой страницы
      const LS_KEY = 'qa_checks_status__PAGE_B';

      // Массив проверок
      const CHECKS = [
        { id: 'mask-default-plus7',      text: 'По умолчанию в поле ввода телефона маска +7 ХХХ ХХХ ХХ ХХ' },
        { id: 'enter-7-autoprefix',      text: 'Ввод цифры 7 приводит к автоподстановке маски +7' },
        { id: 'enter-not7-add-plus7',    text: 'Если первая введённая цифра — не 7, к номеру автоматически проставляется +7' },
        { id: 'clear-cross-appears',     text: 'При вводе первой цифры отображается крестик — нажатие удаляет данные в поле' },
        { id: 'clear-cross-disappears',  text: 'Крестик пропадает, если поле очищено' },
        { id: 'checkpass6',  text: 'Нет возможности в поле телефон ввести символы и буквы (только цифры)' },
        { id: 'checkpass7',  text: 'Под полем ввода отображается подсказ "Номер должен содержать 11 цифр (вместе с +7)"' },
        { id: 'checkpass8',  text: 'При переключении способа входа - введенные данные сохраняются' },
        { id: 'checkpass9',  text: 'Стереть данные в полях можно кнопкой backspace и командой ctrA + delete' },
        { id: 'checkpass10',  text: 'При вводе пароля подсвечивается статус защищенности' },
        { id: 'checkpass11',  text: 'При вводе первого символа отображается крестик — нажатие удаляет данные в поле' },
        { id: 'checkpass12',  text: 'При нажатии на крестик - данные стираются + пропадает статус защищенности' },
        { id: 'checkpass13',  text: 'Статус защищенности делится на: легкий, средний, хороший' },
        { id: 'checkpass14',  text: 'Статус хороший - если в пароле есть цифры, нижний и верхний регистр и символы (не менее 8)' },
        { id: 'checkpass15',  text: 'Статус средний - если цифры и буквы (не более 8)' },
        { id: 'checkpass16',  text: 'При нажатии на кнопку войти отправляется Post запрос' },
        { id: 'checkpass17',  text: 'Post запрос передает логин и пароль в зашифрованном виде' },
        { id: 'checkpass18',  text: 'При ошибке входа отображается "Упс! Не можем впустить Вас"' },
        { id: 'checkpass19',  text: 'На Post запрос приходит токен авторизации' },
        { id: 'checkpass20',  text: 'Поп-ап отображает заголовок, подзаголовок, кнопка "Отчет об ошибке", ок и крестик' },
        { id: 'checkpass21',  text: 'Вкладка Email содержит поля имейл и пароль' },
        { id: 'checkpass22',  text: 'Маска поля email проверяет символ @ и домен ru' },
        { id: 'checkpass23',  text: 'При нарушении маски под полем отображается подсказка' },
        { id: 'checkpass24',  text: 'Подсказка содержит "Введите корректный email"' },
        { id: 'checkpass25',  text: 'При обновлении данные полей ввода/вкладки сохраняются' }
      ];

      function readStatuses(){
        try {
          const raw = localStorage.getItem(LS_KEY);
          const parsed = raw ? JSON.parse(raw) : {};
          return (parsed && typeof parsed === 'object') ? parsed : {};
        } catch(e){ return {}; }
      }
      function writeStatuses(map){
        try { localStorage.setItem(LS_KEY, JSON.stringify(map)); } catch(e){}
      }

      // добавили поддержку 'pending' (по умолчанию)
      function applyStatus(itemEl, status){
        const statusEl = itemEl.querySelector('.bug-status');
        const btnOpen  = itemEl.querySelector('.btn-open');
        const btnFixed = itemEl.querySelector('.btn-fixed');

        itemEl.classList.remove('status-open','status-fixed','status-pending');
        btnOpen.setAttribute('aria-pressed','false');
        btnFixed.setAttribute('aria-pressed','false');

        if (status === 'fixed'){
          itemEl.classList.add('status-fixed');
          statusEl.textContent = 'Статус: успешно';
          btnFixed.setAttribute('aria-pressed','true');
        } else if (status === 'open'){
          itemEl.classList.add('status-open');
          statusEl.textContent = 'Статус: баг';
          btnOpen.setAttribute('aria-pressed','true');
        } else {
          // по умолчанию — не проверено
          itemEl.classList.add('status-pending');
          statusEl.textContent = 'Статус: не проверено';
          // обе кнопки остаются не нажаты
        }
      }

      function renderList(){
        const statuses = readStatuses();
        list.innerHTML = '';

        CHECKS.forEach(check => {
          const node = tpl.content.firstElementChild.cloneNode(true);
          node.setAttribute('data-bug-id', check.id);
          node.querySelector('.bug-text').textContent = check.text;

          // если статуса нет — 'pending'
          const current = statuses[check.id] || 'pending';
          applyStatus(node, current);

          node.querySelector('.btn-open').addEventListener('click', () => {
            statuses[check.id] = 'open';
            writeStatuses(statuses);
            applyStatus(node, 'open');
          });
          node.querySelector('.btn-fixed').addEventListener('click', () => {
            statuses[check.id] = 'fixed';
            writeStatuses(statuses);
            applyStatus(node, 'fixed');
          });

          list.appendChild(node);
        });
      }

      fab.addEventListener('click', () => {
        panel.style.display = (panel.style.display === 'flex') ? 'none' : 'flex';
        if(panel.style.display === 'flex') renderList();
      });

      document.addEventListener('DOMContentLoaded', () => {
        if(getComputedStyle(panel).display !== 'none') renderList();
      });
    })();
</script>


<!-- Сценарии -->
<script>
    (function() {
      const root = document.documentElement;
      const btn  = document.getElementById('theme-toggle');
      const saved = localStorage.getItem('theme');
      if (saved === 'dark' || saved === 'light') {
        root.setAttribute('data-theme', saved);
        btn.classList.toggle('active', saved === 'dark');
      }
      btn.addEventListener('click', () => {
        const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        root.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
        btn.classList.toggle('active', next === 'dark');
      });
    })();
</script>
<script>
    (function() {
      const imgs = [
        'img/QAtoDev_(Flappy_Bird_style).png',
        'img/QAtoDev_Classic.png',
        'img/QAtoDev_new_year.png',
        'img/QAtoDev_DayQA.png',
        'img/QAtoDev_Halloween.png',
        'img/QAtoDev_BlackAndWhite.png',
        'img/QAtoDev_CoverChatChannel.png'
      ];
      let idx = parseInt(localStorage.getItem('logoIdx'), 10);
      if (isNaN(idx) || idx < 0 || idx >= imgs.length) idx = 0;
      const logoImg    = document.querySelector('.logo img');
      const faviconTag = document.querySelector('link[rel="icon"]');
      function updateLogo() {
        const src = imgs[idx];
        if (logoImg)    logoImg.src    = src;
        if (faviconTag) faviconTag.href = src;
      }
      updateLogo();
      setInterval(() => {
        idx = (idx + 1) % imgs.length;
        localStorage.setItem('logoIdx', idx);
        updateLogo();
      }, 50000);
    })();
</script>
<script>
    document.addEventListener('DOMContentLoaded', function(){
        const phoneContainer = document.getElementById('phone-container');
        const emailContainer = document.getElementById('email-container');
        document.querySelectorAll('input[name="login-method"]').forEach(radio=>{
            radio.addEventListener('change', ()=> {
                if(radio.value==='phone'){
                    phoneContainer.style.display='block';
                    emailContainer.style.display='none';
                } else {
                    phoneContainer.style.display='none';
                    emailContainer.style.display='block';
                }
            });
        });

        function setupClear(inputId, clearBtnId){
            const input = document.getElementById(inputId);
            const btn = document.getElementById(clearBtnId);
            input.addEventListener('input', function(){
                btn.style.display = input.value ? 'block':'none';
            });
            btn.addEventListener('click', function(){
                input.value = '';
                input.dispatchEvent(new Event('input'));
                input.focus();
            });
        }
        setupClear('phone-input','clear-phone');
        setupClear('email-input','clear-email');
        setupClear('password-input','clear-password');

        // Маска телефона
        const phoneInput = document.getElementById('phone-input');
        phoneInput.addEventListener('input', function(){
            let val = phoneInput.value.replace(/\D/g, '');
            if(val.startsWith('8')) val = '7' + val.slice(1);
            if(!val.startsWith('7')) val = '7'+val;
            let formatted = '+7';
            if(val.length>1) formatted += ' ('+val.slice(1,4);
            if(val.length>=4) formatted += ') '+val.slice(4,7);
            if(val.length>=7) formatted += '-'+val.slice(7,9);
            if(val.length>=9) formatted += '-'+val.slice(9,11);
            phoneInput.value = formatted;
        });

        // Сила пароля
        const pwdInput = document.getElementById('password-input');
        const strengthText = document.getElementById('password-strength');
        pwdInput.addEventListener('input', function(){
            const v = pwdInput.value;
            let score=0;
            if(v.length>=6) score++;
            if(/[a-z]/.test(v) && /[A-Z]/.test(v)) score++;
            if(/\d/.test(v)) score++;
            if(/[\W_]/.test(v)) score++;
            let text='', color='';
            if(score<=1){ text='Лёгкий'; color='red'; }
            else if(score==2){ text='Средний'; color='orange'; }
            else{ text='Достойный'; color='green'; }
            strengthText.textContent = text;
            strengthText.style.color = color;
        });
    });
</script>

<!-- === Новая логика: отправка запроса на логин + показ поп-апа при 4XX/5XX === -->
<script>
    (function(){
      // Выбираем элементы, которые уже есть в DOM
      const loginBtn = document.getElementById('login-button');
      const phoneInput = document.getElementById('phone-input');
      const emailInput = document.getElementById('email-input');
      const passwordInput = document.getElementById('password-input');

      // Элементы модального окна (ошибки)
      const backdrop = document.getElementById('error-modal-backdrop');
      const closeX   = document.getElementById('error-modal-close-x');
      const okBtn    = document.getElementById('error-modal-ok');
      const detailsBtn = document.getElementById('error-modal-details');
      const modalText = document.getElementById('error-modal-text');

      // Вспомогательные функции управления модалкой
      function showErrorModal(message, details) {
        if (typeof message === 'string' && message.trim()) {
          modalText.textContent = message;
        } else {
          modalText.textContent = 'Произошла ошибка при попытке входа. Попробуйте ещё раз позже.';
        }
        backdrop.classList.add('show');
        backdrop.setAttribute('aria-hidden', 'false');

        // Обработчик "Подробнее" — выводит полезные сведения в консоль
        detailsBtn.onclick = function() {
          console.group('Детали ошибки логина');
          console.log('Сообщение:', message);
          console.log('Технические детали:', details);
          console.groupEnd();
        };
      }
      function hideErrorModal() {
        backdrop.classList.remove('show');
        backdrop.setAttribute('aria-hidden', 'true');
      }

      // Закрытия модалки
      closeX.addEventListener('click', hideErrorModal);
      okBtn.addEventListener('click', hideErrorModal);
      // Клик по подложке закрывает окно
      backdrop.addEventListener('click', function(e){
        if (e.target === backdrop) hideErrorModal();
      });
      // Esc тоже закрывает окно
      document.addEventListener('keydown', function(e){
        if (e.key === 'Escape') hideErrorModal();
      });

      // Основная логика отправки запроса
      loginBtn.addEventListener('click', async function(){
        // Не меняем валидации и существующие обработчики — просто берём значения как есть
        const selectedMethod = document.querySelector('input[name="login-method"]:checked')?.value || 'phone';
        const password = passwordInput.value || '';

        // Нормализуем номер: берём только цифры, чтобы на бэкенде было удобнее
        const rawPhoneDigits = (phoneInput.value || '').replace(/\D/g, '');
        const phoneNormalized = rawPhoneDigits.startsWith('7') ? rawPhoneDigits : ('7' + rawPhoneDigits);

        const email = (emailInput.value || '').trim();

        // Формируем тело запроса: передаём и метод, и то, что ввёл пользователь.
        // Это удобно для тестов — видно, что реально улетает на сервер.
        const payload = {
          method: selectedMethod,               // 'phone' | 'email'
          phone: selectedMethod === 'phone' ? phoneNormalized : null,
          email: selectedMethod === 'email' ? email : null,
          password: password
        };

        // Придуманный (и реальный) адрес для тренировки:
        // https://httpstat.us/500 — возвращает 500 (5XX) при любом методе.
        // Добавим параметр ?sleep=800, чтобы было ощущение реального запроса.
        const LOGIN_ENDPOINT = 'https://httpstat.us/500?sleep=800';

        // Блокируем кнопку на время запроса, чтобы избежать дабл-кликов
        const originalText = loginBtn.textContent;
        loginBtn.disabled = true;
        loginBtn.textContent = 'Входим...';

        try {
          const resp = await fetch(LOGIN_ENDPOINT, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            // Отправляем JSON с телефоном/емейлом и паролем
            body: JSON.stringify(payload)
          });

          // Для демонстрации: читаем текст (если есть) и логируем
          let respText = '';
          try {
            respText = await resp.text();
          } catch(e) {
            // ignore
          }

          console.group('Результат логина');
          console.log('URL:', LOGIN_ENDPOINT);
          console.log('Статус:', resp.status);
          console.log('Статус OK:', resp.ok);
          console.log('Тело ответа:', respText);
          console.log('Отправленный payload:', payload);
          console.groupEnd();

          // ТЗ: при 4XX или 5XX — показываем поп-ап "Что-то пошло не так"
          if (!resp.ok) {
            showErrorModal('Что-то пошло не так', {
              status: resp.status,
              ok: resp.ok,
              responseText: respText
            });
            return; // дальше не идём
          }

          // Если вдруг эндпоинт вернул 2XX (не должен, но на всякий случай):
          // можно было бы редиректить или показывать успех. Оставим лог в консоль.
          console.info('Успешный вход (демо).');

        } catch (err) {
          // Сетевые/непредвиденные ошибки тоже показывают поп-ап
          console.error('Network/Fetch error:', err);
          showErrorModal('Что-то пошло не так', { error: String(err) });
        } finally {
          // Возвращаем кнопку к нормальному состоянию
          loginBtn.disabled = false;
          loginBtn.textContent = originalText;
        }
      });
    })();
</script>
</body>
</html>